= XDCR Data Security

[abstract]
XDCR can be encrypted with TLS.

== Enable XDCR Data Security

To enable XDCR data security, you must be appropriately authorized.
For information, see xref:security:security-authorization.adoc[Authorization].

Proceed as follows:

. On the destination cluster, navigate to menu:Security[Root Certificate], and copy the certificate.
. On the source cluster, left-click on the *XDCR* tab.
This brings up the [.ui]*XDCR Replications* screen.
. Do one of the following:
 ** To create a new cluster-reference, in the [.ui]*Remote Clusters* panel, left-click on the btn:[Add Remote Cluster] button, to the right.
This brings up the [.ui]*Add Remote Cluster* dialog.
 ** To edit an existing cluster-reference, in the [.ui]*Remote Clusters* panel, left-click on the [.ui]*Edit* tab, at the right of the row of an existing cluster-reference.
This brings up the [.ui]*Edit Remote Cluster* dialog.
. In the dialog you have brought up, enter appropriate information for the *Cluster Name*, *IP/Hostname*, *Username for Remote Cluster*, and *Password*.
Then, check the [.ui]*Enable TLS Encryption* checkbox.
When the dialog expands vertically, select one of the following encryption-options:

 ** *Half*, which enables password encryption only.
 ** *Full*, which enables password and data encryption.

+
Paste the copied certificate into the pane at the bottom of the dialog.
The appearance of the dialog is now approximately as follows:
+
[#edit_remote_cluster]
image::xdcr-edit-remote-cluster.png[,360]
+
Left-click on the btn:[Save] button.

. If you are adding a new cluster-reference, in the *Ongoing Replications* panel, click [.ui]*Add Replication*, provide the cluster and bucket information, and click [.ui]*Replicate*.
This starts replication.
+
Alternatively, if you are editing an existing replication, you do not have to take any further action: the existing replication automatically restarts, with TLS enabled.
During restart, XDCR uses the last checkpoint of the replication stream.

Note that it is good practice periodically to rotate XDCR certificates, and instantiate new ones.

== XDCR Data Security Error-Messages

When creating the cluster reference, if certificates on the destination and source clusters are mismatched, the following error message is displayed: `Attention - Got certificate mismatch while trying to send https request to HOST:18091`.

If XDCR is underway, and stops due to a certificate mismatch, the following error message is displayed: `Error replicating vbucket <`_bucketNumber_`>.
Please see logs for details.`
